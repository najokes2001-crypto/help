<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–∂–µ–ª–∞–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è - –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–≤–∞–¥—å–±—ã</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Firebase App (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            padding: 20px;
            font-size: 18px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .main {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            color: #e91e63;
            margin-bottom: 20px;
            font-size: 42px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #555;
            margin: 20px 0;
            font-size: 28px;
        }
        
        h3 {
            font-size: 22px;
            color: #777;
            margin: 15px 0;
        }
        
        .form-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: left;
            border-left: 5px solid #e91e63;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 20px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #e91e63;
            outline: none;
            box-shadow: 0 0 10px rgba(233,30,99,0.3);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        
        .checkbox-group input {
            width: auto;
            margin-right: 10px;
        }
        
        .my_button {
            background: linear-gradient(45deg, #e91e63, #ff4081);
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 20px 0;
            border-radius: 20px;
            font-size: 22px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-block;
        }
        
        .my_button:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(233,30,99,0.4);
        }
        
        .my_button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .secondary_button {
            background: linear-gradient(45deg, #2196f3, #21cbf3);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            border-radius: 15px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-block;
        }
        
        .secondary_button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(33,150,243,0.4);
        }
        
        .admin_button {
            background: linear-gradient(45deg, #ff9800, #ff5722);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            border-radius: 15px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-block;
        }
        
        .admin_button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(255,87,34,0.4);
        }
        
        .spinner {
            width: 70px;
            height: 70px;
            border: 7px solid #f3f3f3;
            border-top: 7px solid #e91e63;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 30px auto;
            display: none;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #f00;
            opacity: 0.8;
            border-radius: 0;
            animation: confettiFall 5s linear forwards;
            z-index: 100;
        }
        
        @keyframes confettiFall {
            from { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            to { transform: translateY(1000px) rotate(720deg); opacity: 0; }
        }
        
        .error-message {
            color: #f44336;
            font-size: 18px;
            margin-top: 10px;
            display: none;
        }
        
        .success-message {
            color: #4caf50;
            font-size: 18px;
            margin-top: 10px;
            display: none;
        }
        
        .instructions {
            background: #ffecb3;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }
        
        .instructions ul {
            margin-left: 20px;
        }
        
        .wishes-info {
            background: #e1f5fe;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-size: 20px;
        }
        
        .wishes-number {
            font-weight: bold;
            color: #e91e63;
            font-size: 24px;
        }
        
        .status-message {
            margin: 15px 0;
            padding: 10px;
            border-radius: 10px;
            font-size: 18px;
        }
        
        .status-waiting {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status-ready {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .sync-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #4caf50;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            display: none;
            z-index: 1000;
        }
        
        .connection-status {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            z-index: 1000;
        }
        
        .connected {
            background: #4caf50;
            color: white;
        }
        
        .disconnected {
            background: #f44336;
            color: white;
        }
        
        .offline-message {
            background: #ff9800;
            color: white;
            padding: 10px;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 2000;
            display: none;
        }
        
        .guest-photo {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid #e91e63;
            margin: 15px auto;
            display: block;
        }
        
        .admin-panel {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
        }
        
        .admin-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid rgba(255, 152, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            color: #888;
            font-size: 18px;
        }
        
        .admin-icon:hover {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }
        
        .admin-icon.admin-active {
            background: rgba(255, 152, 0, 0.3);
            color: #ff5722;
            border-color: #ff5722;
        }
        
        .admin-login-popup {
            position: absolute;
            top: 50px;
            right: 0;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            width: 250px;
            display: none;
            z-index: 1001;
        }
        
        .admin-login-popup input {
            margin: 8px 0;
            padding: 8px;
            font-size: 14px;
        }
        
        .admin-login-popup button {
            padding: 8px 15px;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .admin-section {
            display: none;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px dashed #ddd;
        }
        
        .role-badge {
            position: fixed;
            top: 60px;
            right: 15px;
            background: rgba(156, 39, 176, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            z-index: 1000;
            display: none;
        }
        
        .wishes-list {
            margin-top: 20px;
            text-align: left;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .wish-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #e91e63;
        }
        
        .wish-text {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .wish-author {
            font-style: italic;
            color: #777;
            font-size: 16px;
        }
        
        .wish-date {
            color: #999;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .no-wishes {
            text-align: center;
            padding: 20px;
            color: #777;
            font-style: italic;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π */
        .all-wishes-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e91e63;
        }
        
        .all-wishes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .toggle-wishes-btn {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .all-wishes-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        
        .all-wishes-container.expanded {
            max-height: 1000px;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 32px;
            }
            
            h2 {
                font-size: 24px;
            }
            
            .my_button {
                font-size: 20px;
                padding: 12px 25px;
            }
            
            .connection-status {
                top: 50px;
            }
            
            .guest-photo {
                width: 120px;
                height: 120px;
            }
            
            .admin-panel {
                top: 10px;
                right: 10px;
            }
            
            .admin-icon {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
        }
        
        @media (max-width: 480px) {
            .main {
                padding: 20px;
            }
            
            h1 {
                font-size: 28px;
            }
            
            .form-container {
                padding: 15px;
            }
            
            label, input, select, textarea {
                font-size: 16px;
            }
            
            .guest-photo {
                width: 100px;
                height: 100px;
            }
            
            .admin-login-popup {
                width: 220px;
                right: -80px;
            }
        }
    </style>
</head>
<body>
    <div class="sync-indicator" id="sync-indicator">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...</div>
    <div class="connection-status connected" id="connection-status">‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–æ</div>
    <div class="role-badge" id="role-badge">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</div>
    <div class="offline-message" id="offline-message">
        <i class="fas fa-wifi"></i> –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
    </div>
    
    <div class="admin-panel" id="admin-panel">
        <div class="admin-icon" id="admin-icon" title="–î–æ—Å—Ç—É–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞">
            <i class="fas fa-cog"></i>
        </div>
        <div class="admin-login-popup" id="admin-login-popup">
            <h4 style="margin-bottom: 10px; color: #555;">–î–æ—Å—Ç—É–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞</h4>
            <input type="password" id="admin-password" placeholder="–ü–∞—Ä–æ–ª—å" style="margin-bottom: 10px;">
            <button class="secondary_button" id="login-admin" style="width: 100%;">–í–æ–π—Ç–∏</button>
            <div id="admin-logout" style="display: none; margin-top: 10px;">
                <button class="secondary_button" id="logout-admin" style="width: 100%; background: #f44336;">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class='main' id="main-screen">
            <h1>üí° –ü–æ–∂–µ–ª–∞–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h1>
            <h2>–ü–æ–º–æ–≥–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –Ω–∞—à –¥–µ–Ω—å —Å–≤–∞–¥—å–±—ã –µ—â–µ –ª—É—á—à–µ!</h2>
            
            <div class="instructions">
                <h3>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h3>
                <ul>
                    <li>–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–±—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≥–æ—Å—Ç–µ–π</li>
                    <li>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º–∏ –∏–¥–µ—è–º–∏ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞</li>
                    <li>–í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –±—É–¥—É—Ç —É—á—Ç–µ–Ω—ã –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏</li>
                    <li>–ú–æ–∂–µ—Ç–µ –æ—Å—Ç–∞—Ç—å—Å—è –∞–Ω–æ–Ω–∏–º–Ω—ã–º, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ</li>
                </ul>
            </div>
            
            <div class="form-container">
                <div class="form-group">
                    <label for="guest-select">–ö—Ç–æ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ?</label>
                    <select id="guest-select">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Å—Ç—è --</option>
                        <!-- –ì–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </select>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="anonymous">
                    <label for="anonymous">–•–æ—á—É –æ—Å—Ç–∞—Ç—å—Å—è –∞–Ω–æ–Ω–∏–º–Ω—ã–º</label>
                </div>
                
                <div class="form-group">
                    <label for="wish-text">–í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–≤–∞–¥—å–±—ã:</label>
                    <textarea id="wish-text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –∏–¥–µ–∏ –ø–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—é –ø—Ä–∞–∑–¥–Ω–∏–∫–∞, –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è–º –∏ —Ç.–¥."></textarea>
                </div>
            </div>
            
            <button class="my_button" id="submit-wish">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</button>
            
            <div class="spinner" id="spinner"></div>
            <div class="error-message" id="error-message"></div>
            <div class="success-message" id="success-message"></div>
            
            <div class="wishes-info">
                –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–±—Ä–∞–Ω–æ: <span class="wishes-number" id="wishes-count">0</span>
            </div>
            
            <div class="status-message status-waiting" id="status-message">
                –û–∂–∏–¥–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç –≥–æ—Å—Ç–µ–π...
            </div>
            
            <!-- –ù–æ–≤—ã–π –±–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π -->
            <div class="all-wishes-section">
                <div class="all-wishes-header">
                    <h2>–í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≥–æ—Å—Ç–µ–π</h2>
                    <button class="toggle-wishes-btn" id="toggle-wishes-btn">
                        <i class="fas fa-chevron-down"></i> –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ
                    </button>
                </div>
                
                <div class="all-wishes-container" id="all-wishes-container">
                    <div class="wishes-list" id="all-wishes-list">
                        <!-- –ü–æ–∂–µ–ª–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="admin-section" id="admin-section">
                <button class="admin_button" id="show-wishes">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</button>
                <button class="admin_button" id="clear-wishes">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</button>
            </div>
        </div>
        
        <div class="main" id="wishes-screen" style="display: none;">
            <h2>–í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≥–æ—Å—Ç–µ–π –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–≤–∞–¥—å–±—ã</h2>
            
            <div class="wishes-list" id="wishes-list">
                <!-- –ü–æ–∂–µ–ª–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <button class="my_button" id="back-to-main">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</button>
        </div>
    </div>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –æ –≥–æ—Å—Ç—è—Ö
        const guestNames = [
            "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–î–º–∏—Ç—Ä–∏–π", "–ù–∞—Ç–∞–ª—å—è", "–ì—Ä–∏–≥–æ—Ä–∏–π", "–í–∏–∫—Ç–æ—Ä",
            "–ê–ª–µ–∫—Å–µ–π", "–û–ª—å–≥–∞", "–ù–∞—Ç–∞–ª—å—è", "–û–ª—å–≥–∞", "–†–æ–º–∞–Ω",
            "–õ–∏–ª–∏—è", "–î–∞–Ω–∏–∏–ª", "–ò–ª—å—è", "–ù–∞—Ç–∞–ª—å—è", "–î–∞–Ω–∏–∏–ª",
            "–ê–Ω—Ç–æ–Ω–∏–Ω–∞", "–î–º–∏—Ç—Ä–∏–π", "–ê–ª–µ–Ω–∞", "–ò–ª—å—è", "–î–º–∏—Ç—Ä–∏–π",
            "–ú–∞—Ä–∏—è", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–í–ª–∞–¥", "–õ—é–±–æ–≤—å", "–õ—é–±–æ–≤—å",
            "–†–æ–º–∞–Ω", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ê–Ω–Ω–∞",
            "–Ø—Ä–æ—Å–ª–∞–≤", "–ò–≤–∞–Ω", "–ò–ª—å—è", "–õ—é–±–æ–≤—å", "–ú–∞—Ä–∏–Ω–∞", "–≠–¥–≥–∞—Ä"
        ];

        const guestStatuses = [
            "–ù–µ–≤–µ—Å—Ç–∞ üë∞", "–ñ–µ–Ω–∏—Ö ü§µ", "–ú–∞–º–∞ –Ω–µ–≤–µ—Å—Ç—ã üë©", "–ü–∞–ø–∞ –Ω–µ–≤–µ—Å—Ç—ã üë®", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶",
            "–ü–∞–ø–∞ –∂–µ–Ω–∏—Ö–∞ üë®", "–ú–∞—á–µ—Ö–∞ –∂–µ–Ω–∏—Ö–∞ üë©", "–ë–∞–±—É—à–∫–∞ –∂–µ–Ω–∏—Ö–∞ üëµ", "–ë–∞–±—É—à–∫–∞ –Ω–µ–≤–µ—Å—Ç—ã üëµ", "–ë—Ä–∞—Ç –∂–µ–Ω–∏—Ö–∞ üë¶",
            "–°–µ—Å—Ç—Ä–∞ –∂–µ–Ω–∏—Ö–∞ üëß", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶", "–î—è–¥—è –Ω–µ–≤–µ—Å—Ç—ã üë®", "–ö—Ä–µ—Å—Ç–Ω–∞—è/—Ç–µ—Ç—è –Ω–µ–≤–µ—Å—Ç—ã üë©", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ",
            "–í—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∫–∞ –¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíë", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíÉ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ",
            "–ü–æ–¥—Ä—É–≥–∞ –∂–µ–Ω–∏—Ö–∞ üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ",
            "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ", "–ü–æ–¥—Ä—É–≥–∞ –Ω–µ–≤–µ—Å—Ç—ã üíÉ",
            "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–î—Ä—É–≥ –∂–µ–Ω–∏—Ö–∞ üéÆ", "–î—Ä—É–≥ –Ω–µ–≤–µ—Å—Ç—ã üéÆ", "–°–≤–æ–¥–Ω–∞—è —Å–µ—Å—Ç—Ä–∞ üëß", "–¢–µ—Ç—è –Ω–µ–≤–µ—Å—Ç—ã üë©", "–ë—Ä–∞—Ç –Ω–µ–≤–µ—Å—Ç—ã üë¶"
        ];
        
        // –ü–∞—Ä–æ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
        const ADMIN_PASSWORD = "admin123";
        
        // –¢–µ–∫—É—â–∞—è —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userRole = "guest"; // guest –∏–ª–∏ admin
        
        // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∂–µ–ª–∞–Ω–∏–π
        let wishes = [];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCTguMinuSwBPrV8-xzkvUM9YaO3lLeFeU",
            authDomain: "wedding2025nastyushaproject.firebaseapp.com",
            databaseURL: "https://wedding2025nastyushaproject-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "wedding2025nastyushaproject",
            storageBucket: "wedding2025nastyushaproject.firebasestorage.app",
            messagingSenderId: "868560255743",
            appId: "1:868560255743:web:2c7f6c723ba0fb915a6aca"
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≥–æ—Å—Ç–µ–π
        $(document).ready(function() {
            const guestSelect = $("#guest-select");
            
            for (let i = 0; i < guestNames.length; i++) {
                if (guestStatuses[i] === "–ñ–µ–Ω–∏—Ö ü§µ" || guestStatuses[i] === "–ù–µ–≤–µ—Å—Ç–∞ üë∞") {
                    continue;
                }
                
                guestSelect.append('<option value="' + i + '">' + guestNames[i] + ' - ' + guestStatuses[i] + '</option>');
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            $("#admin-icon").click(function(e) {
                e.stopPropagation();
                $("#admin-login-popup").toggle();
            });
            
            $(document).click(function(e) {
                if (!$(e.target).closest('#admin-panel').length) {
                    $("#admin-login-popup").hide();
                }
            });
            
            $("#login-admin").click(function() {
                const password = $("#admin-password").val();
                if (password === ADMIN_PASSWORD) {
                    setAdminRole();
                    showSuccess("–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä");
                    $("#admin-password").val("");
                    $("#admin-login-popup").hide();
                } else {
                    showError("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
                }
            });
            
            $("#logout-admin").click(function() {
                setGuestRole();
                showSuccess("–í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞");
                $("#admin-login-popup").hide();
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
            $("#submit-wish").click(submitWish);
            $("#show-wishes").click(showWishes);
            $("#clear-wishes").click(clearWishes);
            $("#back-to-main").click(backToMain);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
            $("#toggle-wishes-btn").click(toggleAllWishes);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å
            checkOnlineStatus();
            window.addEventListener('online', checkOnlineStatus);
            window.addEventListener('offline', checkOnlineStatus);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            loadWishes();
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
            setupRealtimeListener();
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Firebase
            testFirebaseConnection();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            checkAdminSession();
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
        function toggleAllWishes() {
            const container = $("#all-wishes-container");
            const button = $("#toggle-wishes-btn");
            
            if (container.hasClass("expanded")) {
                container.removeClass("expanded");
                button.html('<i class="fas fa-chevron-down"></i> –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ');
            } else {
                container.addClass("expanded");
                button.html('<i class="fas fa-chevron-up"></i> –°–∫—Ä—ã—Ç—å');
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
                updateAllWishesList();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
        function updateAllWishesList() {
            const allWishesList = $("#all-wishes-list");
            allWishesList.empty();
            
            if (wishes.length === 0) {
                allWishesList.append('<div class="no-wishes">–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ—Ç –≥–æ—Å—Ç–µ–π</div>');
            } else {
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                const sortedWishes = [...wishes].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                sortedWishes.forEach(wish => {
                    let authorText = "–ê–Ω–æ–Ω–∏–º–Ω—ã–π –≥–æ—Å—Ç—å";
                    
                    if (!wish.anonymous && wish.guestId !== null) {
                        authorText = guestNames[wish.guestId] + " - " + guestStatuses[wish.guestId];
                    }
                    
                    const date = new Date(wish.timestamp);
                    const formattedDate = date.toLocaleString('ru-RU', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    const wishItem = `
                        <div class="wish-item">
                            <div class="wish-text">${wish.wish}</div>
                            <div class="wish-author">${authorText}</div>
                            <div class="wish-date">${formattedDate}</div>
                        </div>
                    `;
                    
                    allWishesList.append(wishItem);
                });
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function checkAdminSession() {
            const isAdmin = localStorage.getItem('weddingAdmin') === 'true';
            if (isAdmin) {
                setAdminRole();
            }
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function setAdminRole() {
            userRole = "admin";
            $("#admin-section").show();
            $("#admin-icon").addClass("admin-active");
            $("#role-badge").show();
            $("#admin-logout").show();
            localStorage.setItem('weddingAdmin', 'true');
        }
        
        // –°–±—Ä–æ—Å —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function setGuestRole() {
            userRole = "guest";
            $("#admin-section").hide();
            $("#admin-icon").removeClass("admin-active");
            $("#role-badge").hide();
            $("#admin-logout").hide();
            localStorage.removeItem('weddingAdmin');
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase
        function testFirebaseConnection() {
            const testRef = database.ref('connection_test');
            testRef.set({
                timestamp: Date.now(),
                message: "Testing connection"
            })
            .then(() => {
                console.log("Firebase connection test: SUCCESS");
            })
            .catch((error) => {
                console.error("Firebase connection test: FAILED", error);
            });
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–∞
        function checkOnlineStatus() {
            if (navigator.onLine) {
                $("#offline-message").hide();
                $("#connection-status").removeClass("disconnected").addClass("connected").text("‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–æ");
            } else {
                $("#offline-message").show();
                $("#connection-status").removeClass("connected").addClass("disconnected").text("‚úó Offline");
                showError("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.");
            }
        }
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        function setupRealtimeListener() {
            const wishesRef = database.ref('wishes');
            
            wishesRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤
                    wishes = Object.values(data);
                    updateWishesCount();
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç
                    if ($("#all-wishes-container").hasClass("expanded")) {
                        updateAllWishesList();
                    }
                } else {
                    wishes = [];
                    updateWishesCount();
                    updateAllWishesList();
                }
            }, (error) => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ–∂–µ–ª–∞–Ω–∏–π:', error);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∂–µ–ª–∞–Ω–∏–π
        function loadWishes() {
            if (!navigator.onLine) {
                showError("–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω—ã.");
                return;
            }
            
            $("#sync-indicator").show();
            
            const wishesRef = database.ref('wishes');
            wishesRef.once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        wishes = Object.values(data);
                    } else {
                        wishes = [];
                    }
                    updateWishesCount();
                    $("#sync-indicator").hide();
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:', error);
                    $("#sync-indicator").hide();
                });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∂–µ–ª–∞–Ω–∏—è
        function saveWish(wish) {
            if (!navigator.onLine) {
                showError("–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ.");
                return Promise.resolve(false);
            }
            
            $("#sync-indicator").show();
            
            const wishesRef = database.ref('wishes');
            const newWishRef = wishesRef.push();
            
            return newWishRef.set(wish)
                .then(() => {
                    $("#sync-indicator").hide();
                    return true;
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:', error);
                    $("#sync-indicator").hide();
                    showError("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.");
                    return false;
                });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è"
        function clearWishes() {
            if (userRole !== "admin") {
                showError("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º");
                return;
            }
            
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.")) {
                clearAllWishes();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –ø–æ–∂–µ–ª–∞–Ω–∏–π
        function clearAllWishes() {
            if (!navigator.onLine) {
                showError("–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã.");
                return;
            }
            
            $("#sync-indicator").show();
            
            const wishesRef = database.ref('wishes');
            wishesRef.remove()
                .then(() => {
                    wishes = [];
                    updateWishesCount();
                    updateAllWishesList();
                    $("#sync-indicator").hide();
                    showSuccess("–í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã!");
                })
                .catch((error) => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:', error);
                    $("#sync-indicator").hide();
                    showError("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.");
                });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è
        function submitWish() {
            const guestId = $("#guest-select").val();
            const anonymous = $("#anonymous").is(":checked");
            const wishText = $("#wish-text").val().trim();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
            if (!guestId && !anonymous) {
                showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Å—Ç—è –∏–ª–∏ –æ—Ç–º–µ—Ç—å—Ç–µ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å");
                return;
            }
            
            if (!wishText) {
                showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ");
                return;
            }
            
            if (wishText.length < 5) {
                showError("–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ. –ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –±–æ–ª–µ–µ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ–µ.");
                return;
            }
            
            $("#spinner").show();
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø–æ–∂–µ–ª–∞–Ω–∏—è
            const newWish = {
                id: Date.now(),
                guestId: guestId,
                anonymous: anonymous,
                wish: wishText,
                timestamp: new Date().toISOString()
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∂–µ–ª–∞–Ω–∏–µ –≤ Firebase
            saveWish(newWish)
                .then((success) => {
                    if (success) {
                        // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                        $("#guest-select").val("");
                        $("#anonymous").prop("checked", false);
                        $("#wish-text").val("");
                        
                        showSuccess("–í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫!");
                        createConfetti();
                    }
                    $("#spinner").hide();
                });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –ø–æ–∂–µ–ª–∞–Ω–∏–π
        function updateWishesCount() {
            const wishesCount = $("#wishes-count");
            const statusMessage = $("#status-message");
            
            wishesCount.text(wishes.length);
            
            if (wishes.length === 0) {
                statusMessage.removeClass("status-ready").addClass("status-waiting")
                    .text("–û–∂–∏–¥–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç –≥–æ—Å—Ç–µ–π...");
            } else {
                statusMessage.removeClass("status-waiting").addClass("status-ready")
                    .text("–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã! –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–∏ –∏–¥–µ–∏.");
            }
        }
        
        // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
        function showError(message) {
            $("#error-message").text(message).show();
            $("#success-message").hide();
            setTimeout(() => $("#error-message").fadeOut(), 5000);
        }
        
        // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ
        function showSuccess(message) {
            $("#success-message").text(message).show();
            $("#error-message").hide();
            setTimeout(() => $("#success-message").fadeOut(), 3000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–∂–µ–ª–∞–Ω–∏–π
        function showWishes() {
            if (userRole !== "admin") {
                showError("–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞–º");
                return;
            }
            
            const wishesList = $("#wishes-list");
            wishesList.empty();
            
            if (wishes.length === 0) {
                wishesList.append('<div class="no-wishes">–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ—Ç –≥–æ—Å—Ç–µ–π</div>');
            } else {
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                const sortedWishes = [...wishes].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                sortedWishes.forEach(wish => {
                    let authorText = "–ê–Ω–æ–Ω–∏–º–Ω—ã–π –≥–æ—Å—Ç—å";
                    
                    if (!wish.anonymous && wish.guestId !== null) {
                        authorText = guestNames[wish.guestId] + " - " + guestStatuses[wish.guestId];
                    }
                    
                    const date = new Date(wish.timestamp);
                    const formattedDate = date.toLocaleString('ru-RU', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    const wishItem = `
                        <div class="wish-item">
                            <div class="wish-text">${wish.wish}</div>
                            <div class="wish-author">${authorText}</div>
                            <div class="wish-date">${formattedDate}</div>
                        </div>
                    `;
                    
                    wishesList.append(wishItem);
                });
            }
            
            $("#main-screen").hide();
            $("#wishes-screen").show();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        function backToMain() {
            $("#wishes-screen").hide();
            $("#main-screen").show();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        function createConfetti() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            const container = $('.container');
            
            for (let i = 0; i < 20; i++) {
                const confetti = $('<div class="confetti"></div>');
                confetti.css({
                    left: Math.random() * 100 + '%',
                    background: colors[Math.floor(Math.random() * colors.length)],
                    transform: 'rotate(' + (Math.random() * 360) + 'deg)'
                });
                
                container.append(confetti);
                
                setTimeout(() => confetti.remove(), 5000);
            }
        }
        
        // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å Firebase
        const connectedRef = database.ref(".info/connected");
        connectedRef.on("value", (snap) => {
            if (snap.val() === true) {
                $("#connection-status").removeClass("disconnected").addClass("connected").text("‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–æ");
                $("#offline-message").hide();
            } else {
                $("#connection-status").removeClass("connected").addClass("disconnected").text("‚úó Offline");
                $("#offline-message").show();
            }
        });
    </script>
</body>
</html>
